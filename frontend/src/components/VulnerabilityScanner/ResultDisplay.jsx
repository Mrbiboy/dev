import React from "react";

const ResultDisplay = ({ result }) => {
  if (!result) return null;

  return (
    <div className="mt-6 w-full max-w-2xl">
      <label htmlFor="scan-result" className="text-gray-400 text-sm mb-2 block">
        Résultat du scan :
      </label>
      {result.status === "success" ? (
        <div className="p-4 bg-gray-950 text-green-300 rounded-lg shadow-inner max-h-96 overflow-auto font-mono text-sm">
          <p className="text-green-400 font-semibold">Aucune vulnérabilité détectée ! ✅</p>
          <p>Statut : {result.status}</p>
          <p>Code de sortie : {result.exit_code}</p>
        </div>
      ) : result.status === "failed" && result.findings && result.findings.length > 0 ? (
        <div className="p-4 bg-gray-950 text-red-300 rounded-lg shadow-inner max-h-96 overflow-auto font-mono text-sm">
          <p className="text-red-400 font-semibold">Vulnérabilités détectées ! ⚠️</p>
          <p>Statut : {result.status}</p>
          <p>Code de sortie : {result.exit_code}</p>
          <p className="mt-2">Détails des vulnérabilités :</p>
          <ul className="list-disc list-inside mt-2">
            {result.findings.map((finding, index) => (
              <li key={index} className="mt-1">
                <span className="text-red-400">{finding.check_id}</span> - {finding.message} (Fichier : {finding.path}, Ligne : {finding.line}, Sévérité : {finding.severity})
              </li>
            ))}
          </ul>
        </div>
      ) : (
        <div className="p-4 bg-gray-950 text-red-300 rounded-lg shadow-inner max-h-96 overflow-auto font-mono text-sm">
          <p className="text-red-400 font-semibold">Erreur lors du scan ! ❌</p>
          <p>Statut : {result.status}</p>
          <p>Erreur : {result.error || "Erreur inconnue"}</p>
        </div>
      )}
    </div>
  );
};

export default ResultDisplay;